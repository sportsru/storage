// Generated by CoffeeScript 1.3.3
var ObjectId, Schema, Storage, app, memcached, mongoose;

app = require('./app');

memcached = require('./memcached');

mongoose = require('mongoose');

Schema = mongoose.Schema;

ObjectId = mongoose.Types.ObjectId;

Storage = require('./models/storage');

app.get('/version/', function(req, res) {
  return Storage.findOne({
    uid: req.uid
  }, function(err, doc) {
    if ((err != null) || !(doc != null)) {
      return res.send(404);
    } else {
      return res.json({
        version: doc.version
      });
    }
  });
});

app.post('/set/', function(req, res) {
  return res.end();
});

app.get('/data/', function(req, res) {
  return Storage.findOne({
    uid: req.uid
  }, function(err, doc) {
    return res.json(doc || {});
  });
});
